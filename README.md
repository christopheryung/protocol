### To-do:
- wrap authentication logic into function
- split negotiation and auth functions 
- handle udp
